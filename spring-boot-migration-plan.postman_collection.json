{
	"info": {
		"_postman_id": "spring-boot-migration-plan",
		"name": "Spring Boot Migration Plan - Project Assistant",
		"description": "Postman collection for sending the Spring Boot DTOs and Mappers Inventory plan to the project assistant API",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "Query Project Assistant with Migration Plan",
			"request": {
				"method": "POST",
				"header": [
					{
						"key": "Authorization",
						"value": "Bearer proj_92-lcvVNUs61dK_cT5UBS5KksgdxzG1tzN_MTokwkQ4",
						"type": "text"
					},
					{
						"key": "Content-Type",
						"value": "application/json",
						"type": "text"
					}
				],
				"body": {
					"mode": "raw",
					"raw": "{\n  \"query\": \"# Spring Boot DTOs and Mappers Inventory\\n\\n## Overview\\n\\nThis document catalogs all DTOs (Data Transfer Objects) and mappers needed for Spring Boot controllers. DTOs will exist only in the controller layer and will be transformed to/from entities using mapper classes.\\n\\n## DTO Structure Patterns\\n\\n### Common DTO Types\\n\\n1. **Create DTOs**: `Create{Entity}Dto` - For POST requests\\n2. **Update DTOs**: `Update{Entity}Dto` - For PATCH/PUT requests\\n3. **List/Query DTOs**: `List{Entity}QueryDto` - For GET query parameters\\n4. **Action DTOs**: Specific action DTOs (e.g., `AcceptInviteDto`, `ToggleCostCodeDto`)\\n5. **Response DTOs**: Optional - for custom response shapes (if different from entities)\\n\\n### Common Query Parameters (across many endpoints)\\n\\n- `orgId` (String, optional) - Organization context\\n- `includeArchived` (Boolean, optional) - Include archived records\\n- `page` (Integer, optional, min=1) - Pagination page number\\n- `limit` (Integer, optional, min=1, max=100-1000) - Pagination limit\\n\\n## DTOs and Mappers by Feature\\n\\n### 1. Authentication (`/auth`)\\n\\n#### DTOs Needed:\\n\\n- `LoginDto` - email, password\\n- `RegisterDto` - username, email, password, firstName, lastName, orgId, organizationName, role, inviteToken, legalAccepted, orgLegalReconfirm\\n- `VerifyEmailDto` - token\\n- `ForgotPasswordDto` - email\\n- `ResetPasswordDto` - token, newPassword\\n- `PasswordStrengthDto` - password\\n- `SetOrgDto` - orgId\\n\\n#### Mappers Needed:\\n\\n- `AuthMapper` - Map RegisterDto to User entity, LoginDto to auth request\\n\\n---\\n\\n### 2. Users (`/users`)\\n\\n#### DTOs Needed:\\n\\n- `CreateUserDto` - username, firstName, lastName, email, password, role, roles, orgId, verificationTokenHash, verificationTokenExpires, resetTokenHash, resetTokenExpires, isEmailVerified, isOrgOwner\\n- `UpdateUserDto` - username, firstName, lastName, email, isEmailVerified, piiStripped, legalHold\\n- `UpdateUserRolesDto` - roles (array)\\n- `ListUsersQueryDto` - includeArchived, orgId\\n- `GetUserQueryDto` - includeArchived\\n\\n#### Mappers Needed:\\n\\n- `UserMapper` - CreateUserDto → User entity, UpdateUserDto → User entity updates, User entity → UserResponseDto (if needed)\\n\\n---\\n\\n### 3. Organizations (`/organizations`)\\n\\n#### DTOs Needed:\\n\\n- `CreateOrganizationDto` - name, metadata, databaseUri, datastoreUri, databaseName, primaryDomain, useDedicatedDb, datastoreType, dataResidency, piiStripped, legalHold\\n- `UpdateOrganizationDto` - name, metadata\\n- `UpdateOrganizationDatastoreDto` - useDedicatedDb, type, databaseUri, datastoreUri, databaseName, dataResidency\\n- `UpdateOrganizationLegalHoldDto` - legalHold\\n- `UpdateOrganizationPiiDto` - piiStripped\\n- `ListOrganizationsDto` - search, includeArchived, datastoreType, legalHold, piiStripped, page, limit\\n\\n#### Mappers Needed:\\n\\n- `OrganizationMapper` - CreateOrganizationDto → Organization entity, UpdateOrganizationDto → Organization entity updates, Organization entity → OrganizationResponseDto\\n\\n---\\n\\n### 4. Companies (`/companies`)\\n\\n#### DTOs Needed:\\n\\n- `CreateCompanyDto` - name, externalId, website, mainEmail, mainPhone, companyTypeKeys, tagKeys, rating, notes\\n- `UpdateCompanyDto` - name, externalId, website, mainEmail, mainPhone, companyTypeKeys, tagKeys, rating, notes (all optional)\\n- `ListCompaniesQueryDto` - orgId, includeArchived, includeCounts, search, type, tag, page, limit\\n\\n#### Mappers Needed:\\n\\n- `CompanyMapper` - CreateCompanyDto → Company entity, UpdateCompanyDto → Company entity updates, Company entity → CompanyResponseDto\\n\\n---\\n\\n### 5. Company Locations (`/company-locations`)\\n\\n#### DTOs Needed:\\n\\n- `CreateCompanyLocationDto` - companyId, name, externalId, timezone, email, phone, addressLine1, addressLine2, city, region, postal, country, tagKeys, notes\\n- `UpdateCompanyLocationDto` - name, externalId, timezone, email, phone, addressLine1, addressLine2, city, region, postal, country, tagKeys, notes (all optional)\\n- `ListCompanyLocationsQueryDto` - orgId, includeArchived, companyId, search, tag, page, limit\\n\\n#### Mappers Needed:\\n\\n- `CompanyLocationMapper` - CreateCompanyLocationDto → CompanyLocation entity, UpdateCompanyLocationDto → CompanyLocation entity updates, CompanyLocation entity → CompanyLocationResponseDto\\n\\n---\\n\\n### 6. Persons (`/persons`)\\n\\n#### DTOs Needed:\\n\\n- `CreatePersonDto` - personType (enum: internal_staff, internal_union, external_person), displayName, firstName, lastName, dateOfBirth, emails (array), primaryEmail, phones (array), primaryPhone, tagKeys, skillKeys, departmentKey, orgLocationId, reportsToPersonId, ironworkerNumber, unionLocal, skillFreeText, certifications (array of PersonCertificationDto), rating, notes, companyId, companyLocationId, title\\n- `UpdatePersonDto` - Same fields as CreatePersonDto (all optional)\\n- `PersonCertificationDto` - name, issuedAt, expiresAt, documentUrl, notes (nested DTO)\\n- `ListPersonsQueryDto` - orgId, includeArchived, personType, companyId, orgLocationId, companyLocationId, departmentKey, skillKey, search, tag, page, limit\\n\\n#### Mappers Needed:\\n\\n- `PersonMapper` - CreatePersonDto → Person entity (including embedded PersonEmail, PersonPhone, ContactCertification), UpdatePersonDto → Person entity updates, Person entity → PersonResponseDto\\n\\n---\\n\\n### 7. Contacts (`/contacts`) - Read-only (deprecated writes)\\n\\n#### DTOs Needed:\\n\\n- `ListContactsQueryDto` - orgId, includeArchived, personType (query params only, no body DTOs needed for deprecated endpoints)\\n\\n#### Mappers Needed:\\n\\n- `ContactMapper` - Contact entity → ContactResponseDto (for read operations)\\n\\n---\\n\\n### 8. Projects (`/projects`)\\n\\n#### DTOs Needed:\\n\\n- `CreateProjectDto` - name, description, orgId, officeId, projectCode, status, location, bidDate, awardDate, fabricationStartDate, fabricationEndDate, erectionStartDate, erectionEndDate, completionDate, budget (object), quantities (object), staffing (object), costCodeBudgets (array)\\n- `UpdateProjectDto` - Same fields as CreateProjectDto (all optional)\\n\\n#### Mappers Needed:\\n\\n- `ProjectMapper` - CreateProjectDto → Project entity (including embedded ProjectBudget), UpdateProjectDto → Project entity updates, Project entity → ProjectResponseDto\\n\\n---\\n\\n### 9. Estimates (`/projects/:projectId/estimates`)\\n\\n#### DTOs Needed:\\n\\n- `CreateEstimateDto` - name, description, notes, lineItems (array of EstimateLineItemDto)\\n- `UpdateEstimateDto` - name, description, notes, status (enum: draft, final), lineItems (array of EstimateLineItemDto) (all optional)\\n- `EstimateLineItemDto` - code, description, quantity, unit, unitCost, total (nested DTO)\\n\\n#### Mappers Needed:\\n\\n- `EstimateMapper` - CreateEstimateDto → Estimate entity, UpdateEstimateDto → Estimate entity updates, Estimate entity → EstimateResponseDto\\n\\n---\\n\\n### 10. Offices (`/offices` or `/org-locations`)\\n\\n#### DTOs Needed:\\n\\n- `CreateOfficeDto` - name, orgId, address, description, timezone, orgLocationTypeKey, tagKeys, parentOrgLocationId, sortOrder\\n- `UpdateOfficeDto` - Same fields as CreateOfficeDto (all optional)\\n- `ListOfficesQueryDto` - orgId, includeArchived, search, parentOrgLocationId, page, limit\\n\\n#### Mappers Needed:\\n\\n- `OfficeMapper` - CreateOfficeDto → Office entity, UpdateOfficeDto → Office entity updates, Office entity → OfficeResponseDto\\n\\n---\\n\\n### 11. Cost Codes (`/cost-codes`)\\n\\n#### DTOs Needed:\\n\\n- `CreateCostCodeDto` - category, code, description (extends CostCodeInputDto)\\n- `CostCodeInputDto` - category, code, description (base DTO)\\n- `UpdateCostCodeDto` - category, code, description (all optional)\\n- `ToggleCostCodeDto` - active (boolean)\\n- `BulkCostCodesDto` - codes (array of CostCodeInputDto)\\n- `SeedCostCodesDto` - pack, replace\\n- `CostCodeImportCommitDto` - codes (array of CostCodeInputDto, optional)\\n- `ListCostCodesQueryDto` - q, category, active, noPagination, updatedSince, page, limit\\n\\n#### Mappers Needed:\\n\\n- `CostCodeMapper` - CreateCostCodeDto → CostCode entity, UpdateCostCodeDto → CostCode entity updates, CostCode entity → CostCodeResponseDto\\n\\n---\\n\\n### 12. RBAC (`/rbac`)\\n\\n#### DTOs Needed:\\n\\n- `UpdateUserRolesDto` - roles (array) - reused from Users feature\\n- No query DTOs needed (uses path/query params)\\n\\n#### Mappers Needed:\\n\\n- `RbacMapper` - Role hierarchy mapping, User roles mapping\\n\\n---\\n\\n### 13. Bulk Operations (`/bulk-import/:entityType`, `/bulk-export/:entityType`)\\n\\n#### DTOs Needed:\\n\\n- No specific DTOs (uses file upload and query params)\\n- Entity types: users, contacts, projects, offices\\n\\n#### Mappers Needed:\\n\\n- `BulkMapper` - CSV/JSON parsing, entity type-specific mapping\\n\\n---\\n\\n### 14. Invites (`/invites`)\\n\\n#### DTOs Needed:\\n\\n- `CreateInviteDto` - personId, role, expiresInHours\\n- `AcceptInviteDto` - token, username, password\\n\\n#### Mappers Needed:\\n\\n- `InviteMapper` - CreateInviteDto → Invite entity, AcceptInviteDto → User creation\\n\\n---\\n\\n### 15. Email Templates (`/email-templates`)\\n\\n#### DTOs Needed:\\n\\n- `UpdateEmailTemplateDto` - locale, subject, html, text\\n- `PreviewEmailTemplateDto` - locale, variables (object)\\n- `TestSendTemplateDto` - extends PreviewEmailTemplateDto, adds: to (email)\\n\\n#### Mappers Needed:\\n\\n- `EmailTemplateMapper` - UpdateEmailTemplateDto → EmailTemplate entity, EmailTemplate entity → EmailTemplateResponseDto\\n\\n---\\n\\n### 16. Email (`/email`)\\n\\n#### DTOs Needed:\\n\\n- `SendEmailDto` - email, subject, text, body, html, templateName, orgId, variables (object), mode, bcc (array)\\n\\n#### Mappers Needed:\\n\\n- `EmailMapper` - SendEmailDto → Email request object\\n\\n---\\n\\n### 17. Compliance (`/compliance`)\\n\\n#### DTOs Needed:\\n\\n- `StripPiiDto` - entityType (enum), entityId\\n- `SetLegalHoldDto` - entityType (enum), entityId, legalHold, reason\\n- `BatchArchiveDto` - entityType (enum), entityIds (array), archive\\n\\n#### Mappers Needed:\\n\\n- `ComplianceMapper` - DTOs to compliance operation requests\\n\\n---\\n\\n### 18. Contact Inquiries (`/marketing/contact-inquiries`)\\n\\n#### DTOs Needed:\\n\\n- `CreateContactInquiryDto` - name, email, message, source, trap\\n- `UpdateContactInquiryDto` - status (enum: new, in-progress, closed), responderId\\n- `VerifyContactInquiryDto` - name, email, trap\\n- `ConfirmContactInquiryDto` - email, code\\n- `ListContactInquiriesDto` - status, page, limit\\n\\n#### Mappers Needed:\\n\\n- `ContactInquiryMapper` - CreateContactInquiryDto → ContactInquiry entity, UpdateContactInquiryDto → ContactInquiry entity updates, ContactInquiry entity → ContactInquiryResponseDto\\n\\n---\\n\\n### 19. Sessions (`/sessions`)\\n\\n#### DTOs Needed:\\n\\n- `RevokeSessionDto` - sessionId\\n\\n#### Mappers Needed:\\n\\n- `SessionMapper` - Session entity → SessionResponseDto\\n\\n---\\n\\n### 20. Seats (`/seats`)\\n\\n#### DTOs Needed:\\n\\n- No DTOs (uses query params only)\\n\\n#### Mappers Needed:\\n\\n- `SeatMapper` - Seat entity → SeatResponseDto\\n\\n---\\n\\n### 21. People Import (`/people/import`)\\n\\n#### DTOs Needed:\\n\\n- `PeopleImportPreviewDto` - rows (array of PeopleImportRowDto)\\n- `PeopleImportRowDto` - row, personType, name, email, phone, company, ironworkerNumber, unionLocal, dateOfBirth, skills, certifications, notes, inviteRole\\n- `PeopleImportConfirmDto` - rows (array of PeopleImportConfirmRowDto)\\n- `PeopleImportConfirmRowDto` - extends PeopleImportRowDto, adds: action (enum: create, update, skip), personId, contactId\\n- `PeopleImportV1PreviewDto` - rows (array of PeopleImportV1RowDto)\\n- `PeopleImportV1RowDto` - row, personType, displayName, emails, primaryEmail, phones, primaryPhone, tagKeys, skillKeys, departmentKey, title, orgLocationName, reportsToDisplayName, companyExternalId, companyName, companyLocationExternalId, companyLocationName, ironworkerNumber, unionLocal, certifications, rating, notes, inviteRole\\n- `PeopleImportV1ConfirmDto` - rows (array of PeopleImportV1ConfirmRowDto)\\n- `PeopleImportV1ConfirmRowDto` - extends PeopleImportV1RowDto, adds: action (enum: create, update, skip), personId\\n\\n#### Mappers Needed:\\n\\n- `PeopleImportMapper` - Import row DTOs → Person/Contact entities\\n\\n---\\n\\n### 22. Companies Import (`/companies/import/v1`)\\n\\n#### DTOs Needed:\\n\\n- `CompaniesImportPreviewDto` - rows (array of CompaniesImportRowDto)\\n- `CompaniesImportRowDto` - row, companyName, companyTypeKeys, companyTagKeys, companyExternalId, website, mainEmail, mainPhone, notes, locationName, locationExternalId, locationEmail, locationPhone, locationAddressLine1, locationCity, locationRegion, locationPostal, locationCountry, locationTagKeys, locationNotes\\n- `CompaniesImportConfirmDto` - rows (array of CompaniesImportConfirmRowDto)\\n- `CompaniesImportConfirmRowDto` - extends CompaniesImportRowDto, adds: action (enum: upsert, skip)\\n\\n#### Mappers Needed:\\n\\n- `CompaniesImportMapper` - Import row DTOs → Company/CompanyLocation entities\\n\\n---\\n\\n### 23. Ingestion Contacts (`/ingestion/contacts/v1`)\\n\\n#### DTOs Needed:\\n\\n- `IngestionContactsSuggestMappingDto` - profile (enum), headers (array), allowAiProcessing\\n- `IngestionContactsParseRowDto` - profile (enum), cells (object), allowAiProcessing\\n- `IngestionContactsEnrichDto` - profile (enum), candidate (IngestionContactDraftDto), allowAiProcessing\\n- `IngestionContactDraftDto` - person (IngestionPersonDraftDto), companyName\\n- `IngestionPersonDraftDto` - displayName, emails (array), phones (array)\\n\\n#### Mappers Needed:\\n\\n- `IngestionMapper` - Ingestion DTOs → Person/Company entities\\n\\n---\\n\\n### 24. Waitlist (`/marketing/waitlist`)\\n\\n#### DTOs Needed:\\n\\n- `StartWaitlistDto` - email, name, phone, role, source, preCreateAccount, marketingConsent, trap\\n- `VerifyWaitlistDto` - email, code\\n- `ResendWaitlistDto` - email\\n- `VerifyWaitlistPhoneDto` - email, code\\n- `ListWaitlistDto` - status, verifyStatus, cohortTag, emailContains, page, limit\\n- `InviteBatchDto` - limit, cohortTag\\n- `ApproveWaitlistDto` - email, cohortTag\\n- `WaitlistEventDto` - event, meta, source, path\\n\\n#### Mappers Needed:\\n\\n- `WaitlistMapper` - Waitlist DTOs → Waitlist entity, Waitlist entity → WaitlistResponseDto\\n\\n---\\n\\n### 25. Org Taxonomy (`/org-taxonomy`)\\n\\n#### DTOs Needed:\\n\\n- `PutOrgTaxonomyDto` - values (array of PutOrgTaxonomyValueDto)\\n- `PutOrgTaxonomyValueDto` - key, label, sortOrder, color, metadata\\n\\n#### Mappers Needed:\\n\\n- `OrgTaxonomyMapper` - PutOrgTaxonomyDto → OrgTaxonomy entity, OrgTaxonomy entity → OrgTaxonomyResponseDto\\n\\n---\\n\\n### 26. Legal (`/legal`)\\n\\n#### DTOs Needed:\\n\\n- `CreateLegalDocDto` - type (enum), version, content, effectiveAt\\n- `AcceptLegalDocDto` - docType (enum), version\\n\\n#### Mappers Needed:\\n\\n- `LegalMapper` - CreateLegalDocDto → LegalDoc entity, AcceptLegalDocDto → LegalAcceptance entity\\n\\n---\\n\\n### 27. Graph Edges (`/graph-edges`)\\n\\n#### DTOs Needed:\\n\\n- `CreateGraphEdgeDto` - fromNodeType (enum), fromNodeId, toNodeType (enum), toNodeId, edgeTypeKey, metadata, effectiveFrom, effectiveTo\\n- `ListGraphEdgesQueryDto` - orgId, includeArchived, fromNodeType, fromNodeId, toNodeType, toNodeId, edgeTypeKey, page, limit\\n\\n#### Mappers Needed:\\n\\n- `GraphEdgeMapper` - CreateGraphEdgeDto → GraphEdge entity, GraphEdge entity → GraphEdgeResponseDto\\n\\n---\\n\\n### 28. Notifications (`/notifications`)\\n\\n#### DTOs Needed:\\n\\n- `ListNotificationsQueryDto` - read, page, limit\\n\\n#### Mappers Needed:\\n\\n- `NotificationMapper` - Notification entity → NotificationResponseDto\\n\\n---\\n\\n### 29. CRM Context (`/crm-context`)\\n\\n#### DTOs Needed:\\n\\n- `ListCrmContextDocumentsQueryDto` - orgId, entityType (enum), includeArchived, page, limit\\n\\n#### Mappers Needed:\\n\\n- `CrmContextMapper` - CrmContext entity → CrmContextResponseDto\\n\\n---\\n\\n### 30. Events (`/events`)\\n\\n#### DTOs Needed:\\n\\n- `ListEventsDto` - entityType, entityId, actor, action, eventType, cursor, archived, createdAtGte, createdAtLte, offset, limit, orgId, sort\\n\\n#### Mappers Needed:\\n\\n- `EventMapper` - Event entity → EventResponseDto\\n\\n---\\n\\n### 31. Health (`/health`)\\n\\n#### DTOs Needed:\\n\\n- None (no request/response DTOs needed)\\n\\n#### Mappers Needed:\\n\\n- None\\n\\n---\\n\\n## Mapper Implementation Strategy\\n\\n### Mapper Interface Pattern\\n\\nEach mapper should implement:\\n\\n- `toEntity(dto)` - Convert DTO to Entity\\n- `toDto(entity)` - Convert Entity to DTO (for responses)\\n- `updateEntity(entity, dto)` - Update existing entity with DTO values\\n\\n### Common Mapping Concerns\\n\\n1. **String Trimming**: Many DTOs have `@Transform` decorators that trim strings - mappers should preserve this behavior\\n2. **Email Lowercasing**: Email fields should be lowercased\\n3. **Date Parsing**: Date strings need to be converted to LocalDate/LocalDateTime\\n4. **Nested Objects**: Handle embedded objects (e.g., PersonEmail, PersonPhone, ProjectBudget)\\n5. **Arrays**: Handle collections properly (emails, phones, tags, etc.)\\n6. **Enums**: Map string values to Java enums\\n7. **Optional Fields**: Handle nullable/optional fields appropriately\\n8. **Organization Context**: Extract orgId from actor context when not in DTO\\n\\n### Mapper Naming Convention\\n\\n- `{Entity}Mapper` - e.g., `UserMapper`, `CompanyMapper`, `PersonMapper`\\n- Located in: `com.mytegroup.api.mapper` package\\n\\n### DTO Naming Convention\\n\\n- `{Action}{Entity}Dto` - e.g., `CreateUserDto`, `UpdateCompanyDto`, `ListPersonsQueryDto`\\n- Located in: `com.mytegroup.api.dto.{feature}` package\\n\\n## Controller Migration Strategy\\n\\n### Overview\\n\\nControllers are the entry point for all HTTP requests. Each NestJS controller needs to be migrated to a Spring Boot `@RestController` with appropriate Spring annotations, security configuration, and request/response handling.\\n\\n### Controller Migration Patterns\\n\\n#### NestJS → Spring Boot Mapping\\n\\n| NestJS Pattern | Spring Boot Equivalent |\\n|----------------|----------------------|\\n| `@Controller('path')` | `@RestController` + `@RequestMapping(\\\"/path\\\")` |\\n| `@Get()` | `@GetMapping` |\\n| `@Post()` | `@PostMapping` |\\n| `@Patch()` | `@PatchMapping` |\\n| `@Put()` | `@PutMapping` |\\n| `@Delete()` | `@DeleteMapping` |\\n| `@Body()` | `@RequestBody` |\\n| `@Param('id')` | `@PathVariable(\\\"id\\\")` |\\n| `@Query()` | `@RequestParam` or `@ModelAttribute` for query DTOs |\\n| `@Req()` | `HttpServletRequest` or `@AuthenticationPrincipal` |\\n| `@UseGuards(SessionGuard)` | `@PreAuthorize` or custom `@Component` filter |\\n| `@Roles(Role.Admin)` | `@PreAuthorize(\\\"hasRole('ADMIN')\\\")` or custom annotation |\\n\\n#### Security Migration\\n\\n**NestJS Guards → Spring Security:**\\n\\n1. **SessionGuard** (`SessionGuard`)\\n   - Spring: `@PreAuthorize(\\\"isAuthenticated()\\\")` or custom `Authentication` check\\n   - Extract user from `SecurityContextHolder.getContext().getAuthentication()`\\n\\n2. **OrgScopeGuard** (`OrgScopeGuard`)\\n   - Spring: Custom `@Component` filter or `@PreAuthorize` expression\\n   - Validates organization context from request or user context\\n\\n3. **RolesGuard** (`RolesGuard`)\\n   - Spring: `@PreAuthorize(\\\"hasRole('ROLE_ADMIN')\\\")` or `@Secured({\\\"ROLE_ADMIN\\\"})`\\n   - Map NestJS roles to Spring Security roles (e.g., `Role.Admin` → `ROLE_ADMIN`)\\n\\n**Common Security Pattern:**\\n\\n```java\\n@RestController\\n@RequestMapping(\\\"/api/companies\\\")\\n@PreAuthorize(\\\"isAuthenticated()\\\")\\npublic class CompanyController {\\n    \\n    @GetMapping\\n    @PreAuthorize(\\\"hasAnyRole('ORG_OWNER', 'ORG_ADMIN', 'ADMIN', 'SUPER_ADMIN', 'PLATFORM_ADMIN')\\\")\\n    public ResponseEntity<List<CompanyResponseDto>> list(\\n        @ModelAttribute ListCompaniesQueryDto query,\\n        @AuthenticationPrincipal UserDetails userDetails\\n    ) {\\n        // Implementation\\n    }\\n}\\n```\\n\\n#### Request Context Handling\\n\\n**Actor Extraction Pattern:**\\n\\n```java\\nprivate Actor getActor(Authentication authentication) {\\n    UserDetails userDetails = (UserDetails) authentication.getPrincipal();\\n    // Extract userId, orgId, role from userDetails\\n    return new Actor(userDetails.getUserId(), userDetails.getOrgId(), userDetails.getRole());\\n}\\n\\nprivate String resolveOrgId(Actor actor, String requestedOrgId) {\\n    boolean privileged = actor.getRole() == Role.SUPER_ADMIN || actor.getRole() == Role.PLATFORM_ADMIN;\\n    String orgId = privileged && requestedOrgId != null ? requestedOrgId : actor.getOrgId();\\n    if (orgId == null) {\\n        throw new ForbiddenException(\\\"Missing organization context\\\");\\n    }\\n    return orgId;\\n}\\n```\\n\\n#### Response Handling\\n\\n- Return `ResponseEntity<T>` for full control over status codes and headers\\n- Use `@ResponseStatus` for simple status codes\\n- Return DTOs directly (Spring Boot auto-serializes to JSON)\\n- Use `@ResponseBody` explicitly if needed (usually not required with `@RestController`)\\n\\n### Controllers to Migrate\\n\\n#### 1. Authentication Controller (`/auth`)\\n\\n- **File**: `src/features/auth/auth.controller.ts`\\n- **Endpoints**:\\n  - `POST /auth/register` - Public\\n  - `POST /auth/login` - Public\\n  - `POST /auth/logout` - Authenticated\\n  - `GET /auth/me` - Authenticated\\n  - `POST /auth/set-org` - SuperAdmin/PlatformAdmin\\n  - `POST /auth/verify-email` - Public\\n  - `POST /auth/password-strength` - Public\\n  - `POST /auth/forgot-password` - Public\\n  - `POST /auth/reset-password` - Public\\n  - `GET /auth/users` - Admin/OrgOwner/SuperAdmin\\n- **Special Notes**: Session management, JWT token generation, legal acceptance status\\n\\n#### 2. Users Controller (`/users`)\\n\\n- **File**: `src/features/users/users.controller.ts`\\n- **Endpoints**:\\n  - `GET /users` - List users (Admin+)\\n  - `POST /users` - Create user (Admin+)\\n  - `GET /users/:id` - Get user (Admin+)\\n  - `PATCH /users/:id` - Update user (Admin+)\\n  - `PATCH /users/:id/roles` - Update roles (Admin+)\\n  - `POST /users/:id/archive` - Archive user (Admin+)\\n  - `POST /users/:id/unarchive` - Unarchive user (Admin+)\\n- **Guards**: SessionGuard, OrgScopeGuard, RolesGuard\\n\\n#### 3. Organizations Controller (`/organizations`)\\n\\n- **File**: `src/features/organizations/organizations.controller.ts`\\n- **Endpoints**:\\n  - `POST /organizations` - Create org (SuperAdmin)\\n  - `GET /organizations` - List orgs (SuperAdmin/PlatformAdmin)\\n  - `GET /organizations/:id` - Get org (SuperAdmin/OrgOwner/Admin)\\n  - `PATCH /organizations/:id` - Update org (SuperAdmin/OrgOwner/Admin)\\n  - `PATCH /organizations/:id/archive` - Archive org (SuperAdmin)\\n  - `PATCH /organizations/:id/unarchive` - Unarchive org (SuperAdmin)\\n  - `PATCH /organizations/:id/datastore` - Update datastore (SuperAdmin)\\n  - `POST /organizations/:id/legal-hold` - Set legal hold (SuperAdmin)\\n  - `POST /organizations/:id/pii-stripped` - Set PII stripped (SuperAdmin)\\n- **Special Notes**: Organization access validation, datastore management\\n\\n#### 4. Companies Controller (`/companies`)\\n\\n- **File**: `src/features/companies/companies.controller.ts`\\n- **Endpoints**:\\n  - `GET /companies` - List companies (Admin+)\\n  - `POST /companies` - Create company (Admin+)\\n  - `GET /companies/:id` - Get company (Admin+)\\n  - `PATCH /companies/:id` - Update company (Admin+)\\n  - `POST /companies/:id/archive` - Archive company (Admin+)\\n  - `POST /companies/:id/unarchive` - Unarchive company (Admin+)\\n- **Guards**: SessionGuard, OrgScopeGuard, RolesGuard\\n\\n#### 5. Company Locations Controller (`/company-locations`)\\n\\n- **File**: `src/features/company-locations/company-locations.controller.ts`\\n- **Endpoints**: Similar CRUD pattern as Companies\\n- **Guards**: SessionGuard, OrgScopeGuard, RolesGuard\\n\\n#### 6. Persons Controller (`/persons`)\\n\\n- **File**: `src/features/persons/persons.controller.ts`\\n- **Endpoints**:\\n  - `GET /persons` - List persons (Admin+)\\n  - `POST /persons` - Create person (Admin+)\\n  - `GET /persons/:id` - Get person (Admin+)\\n  - `PATCH /persons/:id` - Update person (Admin+)\\n  - `POST /persons/:id/archive` - Archive person (Admin+)\\n  - `POST /persons/:id/unarchive` - Unarchive person (Admin+)\\n- **Guards**: SessionGuard, OrgScopeGuard, RolesGuard\\n\\n#### 7. Contacts Controller (`/contacts`)\\n\\n- **File**: `src/features/contacts/contacts.controller.ts`\\n- **Endpoints**: Read-only (deprecated writes)\\n- **Guards**: SessionGuard, OrgScopeGuard, RolesGuard\\n\\n#### 8. Projects Controller (`/projects`)\\n\\n- **File**: `src/features/projects/projects.controller.ts`\\n- **Endpoints**:\\n  - `GET /projects` - List projects (Admin/Manager/OrgOwner/PM/Viewer)\\n  - `POST /projects` - Create project (Admin/Manager/OrgOwner)\\n  - `GET /projects/:id` - Get project (Admin/Manager/OrgOwner/PM/Viewer)\\n  - `PATCH /projects/:id` - Update project (Admin/Manager/OrgOwner)\\n  - `POST /projects/:id/archive` - Archive project (Admin/Manager/OrgOwner)\\n  - `POST /projects/:id/unarchive` - Unarchive project (Admin/Manager/OrgOwner)\\n- **Guards**: SessionGuard, OrgScopeGuard, RolesGuard\\n\\n#### 9. Estimates Controller (`/projects/:projectId/estimates`)\\n\\n- **File**: `src/features/estimates/estimates.controller.ts`\\n- **Endpoints**: Nested under projects\\n- **Guards**: SessionGuard, OrgScopeGuard, RolesGuard\\n\\n#### 10. Offices Controller (`/offices` or `/org-locations`)\\n\\n- **File**: `src/features/offices/offices.controller.ts`\\n- **Endpoints**: CRUD operations for offices\\n- **Guards**: SessionGuard, OrgScopeGuard, RolesGuard\\n\\n#### 11. Cost Codes Controller (`/cost-codes`)\\n\\n- **File**: `src/features/cost-codes/cost-codes.controller.ts`\\n- **Endpoints**:\\n  - `GET /cost-codes` - List cost codes\\n  - `POST /cost-codes` - Create cost code\\n  - `PATCH /cost-codes/:id` - Update cost code\\n  - `POST /cost-codes/:id/toggle` - Toggle active status\\n  - `POST /cost-codes/bulk` - Bulk create/update\\n  - `POST /cost-codes/seed` - Seed cost codes\\n  - `POST /cost-codes/import/preview` - Preview import\\n  - `POST /cost-codes/import/commit` - Commit import\\n- **Guards**: SessionGuard, OrgScopeGuard, RolesGuard\\n\\n#### 12. RBAC Controller (`/rbac`)\\n\\n- **File**: `src/features/rbac/rbac.controller.ts`\\n- **Endpoints**: Role-based access control operations\\n- **Guards**: SessionGuard, RolesGuard\\n\\n#### 13. Bulk Operations Controller (`/bulk-import/:entityType`, `/bulk-export/:entityType`)\\n\\n- **File**: `src/features/bulk/bulk.controller.ts`\\n- **Endpoints**: File upload/download for bulk operations\\n- **Special Notes**: Multipart file handling, CSV/JSON parsing\\n\\n#### 14. Invites Controller (`/invites`)\\n\\n- **File**: `src/features/invites/invites.controller.ts`\\n- **Endpoints**:\\n  - `POST /invites` - Create invite\\n  - `POST /invites/:token/accept` - Accept invite\\n- **Guards**: SessionGuard, OrgScopeGuard, RolesGuard\\n\\n#### 15. Email Templates Controller (`/email-templates`)\\n\\n- **File**: `src/features/email-templates/email-templates.controller.ts`\\n- **Endpoints**: Email template CRUD and preview\\n- **Guards**: SessionGuard, RolesGuard\\n\\n#### 16. Email Controller (`/email`)\\n\\n- **File**: `src/features/email/email.controller.ts`\\n- **Endpoints**: Send email\\n- **Guards**: SessionGuard, RolesGuard\\n\\n#### 17. Compliance Controller (`/compliance`)\\n\\n- **File**: `src/features/compliance/compliance.controller.ts`\\n- **Endpoints**: PII stripping, legal hold, batch archive\\n- **Guards**: SessionGuard, RolesGuard (SuperAdmin)\\n\\n#### 18. Contact Inquiries Controller (`/marketing/contact-inquiries`)\\n\\n- **File**: `src/features/contact-inquiries/contact-inquiries.controller.ts`\\n- **Endpoints**: Marketing contact inquiry management\\n- **Guards**: SessionGuard, RolesGuard\\n\\n#### 19. Sessions Controller (`/sessions`)\\n\\n- **File**: `src/features/sessions/sessions.controller.ts`\\n- **Endpoints**: Session management\\n- **Guards**: SessionGuard\\n\\n#### 20. Seats Controller (`/seats`)\\n\\n- **File**: `src/features/seats/seats.controller.ts`\\n- **Endpoints**: Seat management\\n- **Guards**: SessionGuard, RolesGuard\\n\\n#### 21. People Import Controller (`/people/import`)\\n\\n- **File**: `src/features/people/people.controller.ts`\\n- **Endpoints**: People import preview and confirm\\n- **Special Notes**: File upload, CSV parsing, preview/confirm workflow\\n\\n#### 22. Companies Import Controller (`/companies/import/v1`)\\n\\n- **File**: `src/features/companies/companies-import.controller.ts`\\n- **Endpoints**: Companies import preview and confirm\\n- **Special Notes**: File upload, CSV parsing, preview/confirm workflow\\n\\n#### 23. Ingestion Contacts Controller (`/ingestion/contacts/v1`)\\n\\n- **File**: `src/features/ingestion/ingestion-contacts.controller.ts`\\n- **Endpoints**: Contact ingestion with AI processing\\n- **Special Notes**: AI processing, mapping suggestions\\n\\n#### 24. Waitlist Controller (`/marketing/waitlist`)\\n\\n- **File**: `src/features/waitlist/waitlist.controller.ts`\\n- **Endpoints**: Waitlist management\\n- **Guards**: SessionGuard, RolesGuard (some public endpoints)\\n\\n#### 25. Org Taxonomy Controller (`/org-taxonomy`)\\n\\n- **File**: `src/features/org-taxonomy/org-taxonomy.controller.ts`\\n- **Endpoints**: Organization taxonomy management\\n- **Guards**: SessionGuard, OrgScopeGuard, RolesGuard\\n\\n#### 26. Legal Controller (`/legal`)\\n\\n- **File**: `src/features/legal/legal.controller.ts`\\n- **Endpoints**: Legal document management and acceptance\\n- **Guards**: SessionGuard, RolesGuard\\n\\n#### 27. Graph Edges Controller (`/graph-edges`)\\n\\n- **File**: `src/features/graph-edges/graph-edges.controller.ts`\\n- **Endpoints**: Graph edge CRUD operations\\n- **Guards**: SessionGuard, OrgScopeGuard, RolesGuard\\n\\n#### 28. Notifications Controller (`/notifications`)\\n\\n- **File**: `src/features/notifications/notifications.controller.ts`\\n- **Endpoints**: Notification management\\n- **Guards**: SessionGuard\\n\\n#### 29. CRM Context Controller (`/crm-context`)\\n\\n- **File**: `src/features/crm-context/crm-context.controller.ts`\\n- **Endpoints**: CRM context document management\\n- **Guards**: SessionGuard, OrgScopeGuard, RolesGuard\\n\\n#### 30. Events Controller (`/events`)\\n\\n- **File**: `src/common/events/event-log.controller.ts`\\n- **Endpoints**: Event log querying\\n- **Guards**: SessionGuard, OrgScopeGuard, RolesGuard\\n\\n#### 31. Health Controller (`/health`)\\n\\n- **File**: `src/common/health.controller.ts`\\n- **Endpoints**: Health check\\n- **Note**: Replaced by Spring Boot Actuator `/actuator/health`\\n\\n#### 32. Migrations Controller (`/migration`)\\n\\n- **File**: `src/features/migrations/migrations.controller.ts`\\n- **Endpoints**: Migration management (SuperAdmin only)\\n- **Guards**: SessionGuard, OrgScopeGuard, RolesGuard\\n\\n### Controller Implementation Structure\\n\\n#### Standard Controller Pattern\\n\\n```java\\n@RestController\\n@RequestMapping(\\\"/api/companies\\\")\\n@RequiredArgsConstructor\\n@PreAuthorize(\\\"isAuthenticated()\\\")\\npublic class CompanyController {\\n    \\n    private final CompanyService companyService;\\n    private final CompanyMapper companyMapper;\\n    \\n    @GetMapping\\n    @PreAuthorize(\\\"hasAnyRole('ORG_OWNER', 'ORG_ADMIN', 'ADMIN', 'SUPER_ADMIN', 'PLATFORM_ADMIN')\\\")\\n    public ResponseEntity<Page<CompanyResponseDto>> list(\\n        @ModelAttribute ListCompaniesQueryDto query,\\n        @AuthenticationPrincipal UserDetails userDetails,\\n        Pageable pageable\\n    ) {\\n        Actor actor = getActor(userDetails);\\n        String orgId = resolveOrgId(actor, query.getOrgId());\\n        Page<Company> companies = companyService.list(actor, orgId, query, pageable);\\n        Page<CompanyResponseDto> response = companies.map(companyMapper::toDto);\\n        return ResponseEntity.ok(response);\\n    }\\n    \\n    @PostMapping\\n    @PreAuthorize(\\\"hasAnyRole('ORG_OWNER', 'ORG_ADMIN', 'ADMIN', 'SUPER_ADMIN', 'PLATFORM_ADMIN')\\\")\\n    public ResponseEntity<CompanyResponseDto> create(\\n        @RequestBody @Valid CreateCompanyDto dto,\\n        @RequestParam(required = false) String orgId,\\n        @AuthenticationPrincipal UserDetails userDetails\\n    ) {\\n        Actor actor = getActor(userDetails);\\n        String resolvedOrgId = resolveOrgId(actor, orgId);\\n        Company company = companyMapper.toEntity(dto);\\n        Company created = companyService.create(actor, resolvedOrgId, company);\\n        return ResponseEntity.status(HttpStatus.CREATED).body(companyMapper.toDto(created));\\n    }\\n    \\n    // Helper methods\\n    private Actor getActor(UserDetails userDetails) {\\n        // Extract actor from UserDetails\\n    }\\n    \\n    private String resolveOrgId(Actor actor, String requestedOrgId) {\\n        // Resolve organization ID based on actor role\\n    }\\n}\\n```\\n\\n### Common Controller Concerns\\n\\n1. **Pagination**: Use Spring Data's `Pageable` interface\\n2. **Validation**: Use `@Valid` with Jakarta Bean Validation\\n3. **Exception Handling**: Use `@ControllerAdvice` for global exception handling\\n4. **Response Wrapping**: Consider custom response wrapper for consistent API responses\\n5. **File Uploads**: Use `@RequestParam(\\\"file\\\") MultipartFile` for file uploads\\n6. **Query Parameters**: Use `@ModelAttribute` for complex query DTOs\\n7. **Path Variables**: Use `@PathVariable` with validation\\n8. **Request Body**: Use `@RequestBody` with `@Valid` for DTOs\\n\\n### Controller Naming Convention\\n\\n- `{Entity}Controller` - e.g., `CompanyController`, `PersonController`, `ProjectController`\\n- Located in: `com.mytegroup.api.controller.{feature}` package\\n\\n### Migration Checklist per Controller\\n\\n- [ ] Create controller class with `@RestController` and `@RequestMapping`\\n- [ ] Migrate all endpoints with appropriate HTTP method annotations\\n- [ ] Convert NestJS guards to Spring Security annotations\\n- [ ] Migrate request parameter extraction (`@Body`, `@Param`, `@Query`)\\n- [ ] Implement actor extraction from Spring Security context\\n- [ ] Implement organization context resolution\\n- [ ] Add DTO validation with `@Valid`\\n- [ ] Implement proper exception handling\\n- [ ] Add pagination support where needed\\n- [ ] Test all endpoints with appropriate security context\\n- [ ] Update API documentation (OpenAPI/Swagger)\\n\\n## Summary Statistics\\n\\n- **Total DTOs**: ~120+ DTOs across 31 features\\n- **Total Mappers**: ~30+ mapper classes\\n- **Total Controllers**: 32 controllers to migrate\\n- **Common Patterns**: CRUD operations, pagination, filtering, nested objects, file uploads\\n\\n## Implementation Priority\\n\\n### High Priority (Core Business Features)\\n\\n1. **Controllers**: Auth, Users, Organizations, Companies, Persons, Projects, Estimates\\n2. **DTOs & Mappers**: Same features as controllers\\n3. **Rationale**: These are the core business features used most frequently\\n\\n### Medium Priority (Supporting Features)\\n\\n1. **Controllers**: Offices, Cost Codes, Invites, Email Templates, Company Locations\\n2. **DTOs & Mappers**: Same features as controllers\\n3. **Rationale**: Important supporting features but less critical than core features\\n\\n### Low Priority (Administrative & Advanced Features)\\n\\n1. **Controllers**: Waitlist, Ingestion, Bulk Operations, Compliance, Migrations, Events, Notifications\\n2. **DTOs & Mappers**: Same features as controllers\\n3. **Rationale**: Administrative features, advanced workflows, or less frequently used endpoints\\n\\n### Migration Order Recommendation\\n\\n1. **Phase 1**: Set up controller infrastructure (security, exception handling, common utilities)\\n2. **Phase 2**: Migrate high-priority controllers with DTOs and mappers\\n3. **Phase 3**: Migrate medium-priority controllers with DTOs and mappers\\n4. **Phase 4**: Migrate low-priority controllers with DTOs and mappers\\n5. **Phase 5**: Integration testing, performance optimization, documentation\",\n  \"additional_context\": []\n}",
					"options": {
						"raw": {
							"language": "json"
						}
					}
				},
				"url": {
					"raw": "https://api.myte.dev/api/project-assistant/query",
					"protocol": "https",
					"host": [
						"api",
						"myte",
						"dev"
					],
					"path": [
						"api",
						"project-assistant",
						"query"
					]
				},
				"description": "Sends the complete Spring Boot DTOs and Mappers Inventory plan to the project assistant API for processing"
			},
			"response": []
		}
	]
}

